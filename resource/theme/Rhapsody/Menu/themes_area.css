
/* =======================================================================================
   Rhapsody Â· MegaMenu â€” Theme Sectionï¼ˆä¸»é¢˜é¢æ¿ Â· Skyline + Sidebar + Previewï¼‰

   è®¾è®¡ç†å¿µ / Design Concept
   - Skyline æ’ç”»ï¼šé‡‡ç”¨â€œä¸‰å±‚åˆæˆâ€ï¼ˆæš—è§’ / æ¸å˜æŸ“è‰² / æ’ç”»å±‚ï¼‰ï¼Œé€šè¿‡å˜é‡å°±è¿‘å£°æ˜é¿å…å…¨å±€æ±¡æŸ“ï¼Œ
     èƒŒæ™¯ç»Ÿä¸€ pixelated å¤„ç†ï¼Œæä¾› scroll/fixed å¯åˆ‡æ¢çš„è§†å·®ä½“éªŒã€‚
   - å­—ä½“åŸºçº¿ï¼šæ­£æ–‡èµ° AliPuHuiTi/SourceHanSansSCï¼›è‹±æ–‡/æ•°å­—ç”¨ JetBrains Mono NLï¼›ä»£ç å—å¼ºåˆ¶ç­‰å®½ï¼›
     å›¾æ ‡ä¿æŒåŸå­—å½¢ï¼ŒPixel åœºæ™¯å…è®¸å±€éƒ¨æŒ‚ Press Start 2Pã€‚
   - Header è”åŠ¨ï¼šTheme æ¿€æ´»æ—¶ï¼ŒHeader ä¸Šè‰²ã€å›¾æ ‡é‡‘é»„ã€æŒ‰é’®å†…å‘å…‰ï¼Œç»Ÿä¸€åƒç´ æè¾¹ã€‚
   - Sidebar åŒºåŸŸï¼šçº¸æ„Ÿæ¸å˜èƒŒæ™¯ + å†…æ¡†åƒç´ æè¾¹ï¼›åˆ—è¡¨é¡¹ç³–æœè‰² hover æ¸å˜ï¼›æ ‡ç­¾åˆ†è‰²/å›¾æ ‡å ä½ç¬¦ä¸€é”®æ¢è‰²ã€‚
   - Preview æ …æ ¼ï¼šåŠé€æ˜æ¨¡ç³Šç½‘æ ¼ + å¡ç‰‡ç¡¬æè¾¹ï¼›hover ç²‰çº¢æ‰«ææ¡åŠ¨ç”»ï¼›active æä¾›è“è‰²å‹¾é€‰/ç„¦ç‚¹ç¯ã€‚

   Typora Constraints / ç¼–è¾‘å™¨é™åˆ¶
   - ä¸æ”¹ HTML ç»“æ„ï¼ˆno DOM hacksï¼‰ï¼›ä»…ç”¨ CSS æ§åˆ¶ï¼›:has() å•æ¬¡é—¨é—©é™åˆ¶ä½œç”¨åŸŸã€‚
   - æ‰€æœ‰åŠ¨ç”»å‡å°Šé‡ prefers-reduced-motionï¼›æ¶‰åŠæ»šåŠ¨æ¡/æ‰«ææ¡å‡å¯å±€éƒ¨å…³é—­ã€‚
   - å­—ä½“ä¸å›¾æ ‡ï¼šæ˜ç¡®åŒºåˆ† UI å­—ä½“ã€ä»£ç å­—ä½“ã€å›¾æ ‡å­—ä½“ï¼ˆFontAwesomeï¼‰ï¼Œé¿å…äº’ç›¸è¦†ç›–ã€‚

   Performance / æ€§èƒ½ç­–ç•¥
   - å¤šä½¿ç”¨æ¸å˜ã€box-shadowï¼Œå°‘ç”¨å¤§é¢ç§¯æ»¤é•œï¼›å¿…è¦æ—¶åˆæˆåœ¨å±€éƒ¨å˜é‡å±‚ã€‚
   - å˜é‡é›†ä¸­å£°æ˜ï¼ˆ--hero-* / --sb-* / --pv-*ï¼‰ï¼Œæ”¯æŒä¸€å¤„æ¢è‰²å…¨åŸŸè”åŠ¨ã€‚
   - æ»šåŠ¨æ¡ hover åŠ¨æ•ˆé‡‡ç”¨è½»é‡ä½ç§»/äº®åº¦è°ƒèŠ‚ï¼Œé¿å…è¿‡åº¦é‡ç»˜ã€‚

   Maintainability / ç»´æŠ¤ç­–ç•¥
   - åŒºåŸŸåˆ’åˆ†æ¸…æ™°ï¼šA å­—ä½“åŸºçº¿ / B Skyline Surface / C Header Latch / D Sidebar / E Preview Grid / F Scrollbarsã€‚
   - æ¯ä¸ª REGION é™„ Scope / Function / Notesï¼Œæ–¹ä¾¿å¿«é€Ÿæ£€ç´¢ä¸è°ƒå‚ã€‚
   - æä¾› Firefox æ»šåŠ¨æ¡å›é€€ï¼ˆscrollbar-colorï¼‰ï¼Œä¿è¯è·¨å†…æ ¸å…¼å®¹ã€‚

   Accessibility / æ— éšœç¢
   - é«˜å¯¹æ¯”æ–‡æœ¬ä¸æè¾¹ï¼›æŒ‰é’® hover/ç„¦ç‚¹æœ‰æ¸…æ™°åé¦ˆï¼›é¢„è§ˆå¡ active/ç„¦ç‚¹å‡æœ‰å¼ºè§†è§‰å®šä½ã€‚
   ======================================================================================= */

/* ========================================================================== */
/* REGION A â€” TYPE BASEï¼ˆå­—ä½“åŸºçº¿ Â· THEME ä¸“ç”¨ï¼‰                               */
/* Scope : #megamenu-section-themeï¼›ä»¥åŠ Theme æ¿€æ´»æ—¶çš„ #megamenu-menu-sidebar */
/* Function : ä¸­æ–‡æ— è¡¬çº¿åŸºçº¿ï¼›è‹±æ–‡/æ•°å­— JetBrains Monoï¼›ä»£ç ç­‰å®½ï¼›å›¾æ ‡åŸå­—å½¢     */
/* ========================================================================== */

/* å…¨å±€åŸºçº¿ï¼ˆTheme é¢æ¿ + Theme æ¿€æ´»æ—¶çš„å·¦ä¾§èœå•ï¼‰ */
#megamenu-section-theme,
body.megamenu-opened:has(#megamenu-menu-list #m-theme.active) #megamenu-menu-sidebar{
  font-family: 'AliPuHuiTi','SourceHanSansSC',system-ui,-apple-system,"Segoe UI","Microsoft YaHei",sans-serif;
  font-kerning: normal;
  text-rendering: optimizeLegibility;
}

/* è‹±æ–‡/æ•°å­—ä¼˜å…ˆèµ° JetBrains Monoï¼ˆç§‘æŠ€/çª„ä½“æ„Ÿï¼‰ */
#megamenu-section-theme :where(:lang(en), [data-localize], [data-lg]),
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar :where(:lang(en), [data-localize], [data-lg]){
  font-family: 'JetBrainsMonoNL','RobotoMono','AliPuHuiTi','SourceHanSansSC',monospace,system-ui,-apple-system,"Segoe UI","Microsoft YaHei",sans-serif;
  letter-spacing: 0;
}

/* å¸¸è§ UI å…ƒç´ ç»§æ‰¿ï¼ˆä¸æ‹‰å¼€å­—è·ï¼‰ */
#megamenu-section-theme :where(input,button,select,textarea,.btn,.long-btn,th,td,h1,h2,h3,h4,h5,h6,label,span),
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar :where(input,button,select,textarea,.btn,li>a,span,label,h1,h2,h3,h4,h5,h6){
  font-family: inherit;
  letter-spacing: 0;
}

/* ä»£ç åŒºå—ï¼šå¼ºåˆ¶ç­‰å®½ */
#megamenu-section-theme :where(code, pre, kbd, samp),
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar :where(code, pre, kbd, samp){
  font-family: 'JetBrainsMonoNL','RobotoMono',monospace;
}

/* å›¾æ ‡ä¿æŒåŸå­—å½¢/å›¾æ ‡å­—ä½“ */
#megamenu-section-theme :where(i, .icon, [class^="ion-"], [class*=" ion-"], svg),
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar :where(i, .icon, [class^="ion-"], [class*=" ion-"], svg){
  font-family: inherit;
}

/* è½»åƒç´ æè¾¹å¢å¼ºå¯è¯»æ€§ */
#megamenu-section-theme :where(h1,h2,.long-btn,#recent-document-table thead th),
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar :where(.megamenu-menu-header,#megamenu-menu-list>li>a){
  text-shadow: 0.5px 0.5px 0 #fff, -0.5px -0.5px 0 #fff;
}

/* åƒç´ å‘³ï¼ˆå¯é€‰ï¼Œå±€éƒ¨æŒ‚ç±»ï¼‰ */
#megamenu-section-theme :where(.is-pixel, .pixel, .badge-pixel),
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar :where(.is-pixel, .pixel, .badge-pixel){
  font-family: 'Press Start 2P','SourceHanSansPixel',monospace;
}

/* ========================================================================== */
/* REGION B â€” SKYLINE SURFACE Â· Consolidatedï¼ˆå˜é‡+èƒŒæ™¯åˆä¸€ï¼Œä¸ç”¨ :hasï¼‰        */
/* Scope : #megamenu-section-themeï¼ˆTheme é¢æ¿è‡ªèº«ï¼Œæœªæ¿€æ´»æ—¶é€šå¸¸éšè—ï¼‰          */
/* Function : æš—è§’ + æŸ“è‰² + æ’ç”»ä¸‰å±‚ï¼›å˜é‡å°±è¿‘å£°æ˜ï¼Œå‡å°‘å…¨å±€æ±¡æŸ“                 */
/* Notes : é¿å…ç”¨ background ç®€å†™æ¸…ç©ºå±‚ï¼›å¯ç”¨ --hero-attach æ§åˆ¶ç¬¬ä¸‰å±‚é™„ç€        */
/* ========================================================================== */

#megamenu-section-theme{
  /* â€”â€” Skyline å˜é‡ï¼ˆå°±è¿‘ä½œç”¨åŸŸï¼‰ â€”â€” */
  --hero-url: url("../assets/Menu/çº¯å‡€éƒ½å¸‚.png"); /* æ’ç”»è·¯å¾„ï¼šç›¸å¯¹ menu/ åˆ° assets/ */
  --hero-pos: 68% 0%;                             /* æ’ç”»å¯¹é½ç‚¹ï¼šæ°´å¹³ 58â€“72% å¾®è°ƒï¼Œå‚ç›´ 0% é¡¶è´´ */
  --hero-tint-top: rgba(0,156,255,.26);           /* ä¸Šæ–¹è“ç³»æŸ“è‰²ï¼ˆè°ƒå†·/é™äº®ï¼‰ */
  --hero-tint-bottom: rgba(255,77,109,.12);       /* ä¸‹æ–¹ç²‰/çº¢æŸ“è‰²ï¼ˆå’Œ UI ä¸»è‰²å‘¼åº”ï¼‰ */
  --hero-vignette: rgba(17,17,17,.16);            /* è½»æš—è§’ï¼ˆ.10â€“.24 ä¹‹é—´å¾®è°ƒï¼‰ */
  --hero-attach: scroll;                          /* ç¬¬ä¸‰å±‚é™„ç€ï¼šscroll | fixed */

  /* â€”â€” é¢„åˆæˆå±‚ï¼Œå‡å°‘é‡å¤è®¡ç®— â€”â€” */
  --sky-vignette: radial-gradient(120% 100% at 50% 12%,
                    transparent 60%, var(--hero-vignette) 100%);
  --sky-tint: linear-gradient(180deg,
                    var(--hero-tint-top) 0%, var(--hero-tint-bottom) 100%);

  /* â€”â€” ä¸‰å±‚èƒŒæ™¯ï¼šæš—è§’ / æŸ“è‰² / æ’ç”» â€”â€” */
  background-image:
    var(--sky-vignette),
    var(--sky-tint),
    var(--hero-url);
  background-repeat: no-repeat, no-repeat, no-repeat;
  background-position: center, center, var(--hero-pos);
  background-size: cover, cover, cover;
  /* å¯é€‰è§†å·®ï¼šåªå½±å“æ’ç”»å±‚ï¼›å¦‚éœ€å›ºå®šï¼Œæ”¹ä¸º fixed */
  background-attachment: scroll, scroll, var(--hero-attach);
}

/* ========================================================================== */
/* REGION C â€” HEADER LATCHï¼ˆHeader è”åŠ¨ Â· Theme æ¿€æ´» Â· å˜é‡åŒ–ï¼‰                */
/* Scope : body.megamenu-opened:has(#m-theme.active) header                   */
/* Function : Header ä¸Šè‰²ã€å›¾æ ‡é«˜äº®ã€æŒ‰é’®å†…å‘å…‰ï¼›ä¸è¦†ç›– section èƒŒæ™¯           */
/* ========================================================================== */

body.megamenu-opened:has(#megamenu-menu-list #m-theme.active) header{
  /* â€”â€” å¯è°ƒå‚æ•° â€”â€” */
  --hdr-bg1: #fff0f4;          /* åº•å±‚æ¨ªå‘æ¸å˜èµ·ç‚¹ */
  --hdr-bg2: #f5f9ff;          /* åº•å±‚æ¨ªå‘æ¸å˜ç»ˆç‚¹ */
  --hdr-accent: #ff4d6d;       /* å·¦ä¾§ 18px åŠŸèƒ½æ¡é¢œè‰² */
  --hdr-bd: #111;              /* ä¸‹è¾¹æ¡†ä¸»æè¾¹è‰² */
  --hdr-shadow: #93a5b8;       /* Header é˜´å½±è‰² */
  --hdr-icon: #ffcc00;         /* å›¾æ ‡/æŒ‰é’®ä¸»å‰æ™¯ï¼ˆTheme é‡‘é»„ï¼‰ */
  --hdr-btn-inset: #ffd93b33;  /* æŒ‰é’®å†…å‘å…‰ï¼ˆé€æ˜åº¦å¯è°ƒï¼‰ */

  /* â€”â€” èƒŒæ™¯ä¸æè¾¹ â€”â€” */
  background:
    linear-gradient(90deg, var(--hdr-bg1), var(--hdr-bg2)),
    linear-gradient(90deg, var(--hdr-accent) 0, var(--hdr-accent) 18px, transparent 18px);
  image-rendering: pixelated;
  border-bottom: 2px solid var(--hdr-bd);
  box-shadow: 0 2px 0 0 var(--hdr-shadow);
}

/* å…œåº•ï¼šçˆ¶çº§è”åŠ¨ï¼ˆé¿å…è¦†ç›– Skyline å¤šå±‚èƒŒæ™¯ï¼›ä»…è¡¥åƒç´ é£ä¸å†…æ¡†ï¼‰ */
body.megamenu-opened:has(#megamenu-menu-list #m-theme.active) #megamenu-section-theme,
body.megamenu-opened:has(#m-theme.active) *:has(> #megamenu-section-theme){
  image-rendering: pixelated;
  box-shadow: inset 0 0 0 2px #111; /* å¦‚éœ€ç»Ÿä¸€å¯æ”¹ä¸º var(--hdr-bd) */
}

/* Header å›¾æ ‡ä¸æŒ‰é’®ï¼ˆç»Ÿä¸€åƒå˜é‡ï¼‰ */
body.megamenu-opened:has(#megamenu-menu-list #m-theme.active) 
header :is(.btn,.toolbar-icon,.icon,[class*="icon"],[class^="ion-"],i,svg,svg use){
  color: var(--hdr-icon); 
  fill:  var(--hdr-icon); 
  stroke:var(--hdr-icon);
  opacity: 1; 
  filter: none;
}

body.megamenu-opened:has(#megamenu-menu-list #m-theme.active) header .btn{
  border-color: var(--hdr-bd);
  box-shadow: 0 0 0 2px var(--hdr-btn-inset) inset;
  opacity: 1;
}

/* ========================================================================== */
/* REGION D â€” MENU SIDEBAR Â· Consolidatedï¼ˆå·¦ä¾§èœå• Â· Theme æ¿€æ´» Â· å˜é‡åŒ–ï¼‰     */
/* Scope : body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar    */
/* Function : ä¾§æ æ¸å˜ / æ ‡é¢˜ç‰‡ / åˆ—è¡¨é¡¹ / åˆ†éš”çº¿ / æ ‡ç­¾åˆ†è‰² / å›¾æ ‡å ä½ / ç«–çº¿è¡¥é½ */
/* Notes : å•æ¬¡ :has é—¨é—©ï¼›å†…éƒ¨å…¨éƒ¨åä»£é€‰æ‹©ï¼›å¯ä¸€é”®æ¢è‰²                          */
/* ========================================================================== */

body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar{
  /* â€”â€” å¯è°ƒå‚æ•° â€”â€” */
  --sb-bd: #111;               /* ä¸»æè¾¹è‰² */
  --sb-fg: #111;               /* æ–‡æœ¬å‰æ™¯ */
  --sb-shadow: #93a5b8;        /* é»˜è®¤é˜´å½± */
  --sb-shadow-deep: #6f7f90;   /* hover åŠ æ·±é˜´å½± */
  --sb-accent-red: #ff4d6d;    /* çº¢ç²‰åŠŸèƒ½è‰²ï¼ˆæ ‡ç­¾/å›¾æ ‡ï¼‰ */
  --sb-accent-blue: #009cff;   /* è“è‰²åŠŸèƒ½è‰²ï¼ˆhover èƒŒæ™¯/æ ‡ç­¾ï¼‰ */
  --sb-accent-blue-2: #0078d4; /* è“è‰²æ¸å˜å°¾ */
  --sb-accent-warn: #ff8a00;   /* æ©™è‰²åŠŸèƒ½è‰² */
  --sb-accent-close:#e60026;   /* å…³é—­è‰² */

  /* â€”â€” èƒŒæ™¯/çº¹ç† â€”â€” */
  --sb-bg:      linear-gradient(180deg,#fff5f8 0%,#f3f7fb 68%,#fff5f8 100%);
  --sb-hdr-bg:  linear-gradient(180deg,#fff5f8 0%,#eef5ff 100%);
  --sb-list-bg: linear-gradient(180deg,#fff0f4 0%,#f6f9fd 100%);
  --sb-item-bg: linear-gradient(180deg,#fff5f8 0%,#f3f7fb 50%,#fff5f8 100%);
  --sb-div-bg1: linear-gradient(180deg,#fff0f4 0%,#f4f8fd 100%);
  --sb-div-str: repeating-linear-gradient(90deg,var(--sb-accent-red) 0 12px,var(--sb-accent-red) 12px 24px,transparent 24px 36px);

  /* â€”â€” è‡ªèº«å¤–è§‚ â€”â€” */
  background: var(--sb-bg);
  image-rendering: pixelated;
  border-left: 2px solid var(--sb-bd);
  box-shadow: inset 0 0 0 2px var(--sb-bd);
  color: var(--sb-fg);
}

/* Header æ¡å¹… */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar .megamenu-menu-header{
  padding:12px 10px;
  border-bottom:2px solid var(--sb-bd);
  background: var(--sb-hdr-bg);
  box-shadow: 0 2px 0 0 var(--sb-shadow);
  position: relative; /* ä¾›å³ä¾§ç«–çº¿å®šä½ */
}

/* å³ä¾§ç«–çº¿è¡¥é½ï¼ˆä¸»é»‘çº¿ + å†…ç™½æè¾¹ + å¤–å†·ç°è“é˜´å½±ï¼‰ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar .megamenu-menu-header::after{
  content:"";
  position:absolute; top:0; right:0; bottom:0; width:2px;
  background: var(--sb-bd);
  box-shadow:
    inset 0 0 0 2px #fff,
    0 0 0 2px var(--sb-bd),
    2px 0 0 0 var(--sb-shadow);
  pointer-events:none;
  image-rendering:pixelated;
}

/* è¿”å›æŒ‰é’®å›¾æ ‡å¼ºè°ƒ */
body.megamenu-opened:has(#m-theme.active) #megamenu-back-btn i{
  color: var(--sb-accent-red);
  text-shadow: 0 0 2px #ffd93b66;
}

/* æ ‡é¢˜ç‰‡ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-header-title{
  display:inline-block; padding:2px 8px;
  border:2px solid var(--sb-bd);
  background: linear-gradient(180deg,#fff5f8 0%,#f3f7fb 100%);
  box-shadow: 2px 2px 0 0 var(--sb-shadow);
  font-weight:600; color: var(--sb-accent-blue);
}

/* åˆ—è¡¨å®¹å™¨ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list{
  margin:10px 8px 12px; padding:6px 4px;
  border:2px solid var(--sb-bd);
  background: var(--sb-list-bg);
  box-shadow: 3px 3px 0 0 var(--sb-shadow);
}

/* åˆ—è¡¨é¡¹ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list > li > a{
  display:flex; align-items:center; gap:10px; position:relative;
  margin:8px 6px; padding:10px 12px;
  color:var(--sb-fg); text-decoration:none;
  border:2px solid var(--sb-bd); border-radius:0;
  background: var(--sb-item-bg);
  box-shadow: 2px 2px 0 0 var(--sb-shadow), inset 0 0 0 2px #fff;
  transition: transform .06s steps(2,end), box-shadow .06s steps(2,end), background .12s;
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list > li > a i{
  color: var(--sb-accent-red);
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list > li > a:hover{
  transform: translate(-1px,-1px);
  box-shadow: 4px 4px 0 0 var(--sb-shadow-deep), inset 0 0 0 2px #fff;
  background: linear-gradient(180deg,var(--sb-accent-blue) 0%,var(--sb-accent-blue-2) 100%);
  color:#fff;
}

/* æ ‡ç­¾åˆ†è‰²ï¼ˆåˆå¹¶å†™æ³•ï¼‰ */
body.megamenu-opened:has(#m-theme.active)
#megamenu-menu-list :where(#m-new,#m-open,#m-theme,#m-save,#m-saved,#m-save-as,#m-export,#m-print,#m-preference,#m-about,#m-close) > span{
  background: linear-gradient(0deg,#edf3ff,#ffffff);
  border:1.5px solid var(--sb-bd);
  padding:0 4px; display:inline-block;
  font-size:.95em; line-height:1.2; border-radius:0;
  box-shadow:1.5px 1.5px 0 0 var(--sb-shadow);
  font-weight:800;
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list :where(#m-new,#m-open,#m-theme,#m-save,#m-saved,#m-save-as) > span{
  color: var(--sb-accent-red);
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list :where(#m-export,#m-print) > span{
  color: var(--sb-accent-blue);
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list :where(#m-preference,#m-about) > span{
  color: var(--sb-accent-warn);
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list #m-close > span{
  color: var(--sb-accent-close);
}

/* å›¾æ ‡å ä½ï¼ˆTheme ä¸“å± Â· ä¸ Open ä¸é‡å¤ï¼‰ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list > li > a::before{
  display:inline-block; width:1.25em; text-align:center;
  font-size:1em; line-height:1; transform-origin:center; margin-right:-6px;
}
/* å•é¡¹æ˜ å°„ï¼ˆemoji æ–¹æ¡ˆï¼‰ */
body.megamenu-opened:has(#m-theme.active) #m-new::before        { content: "âœ¨"; }
body.megamenu-opened:has(#m-theme.active) #m-open::before       { content: "ğŸ“"; }
body.megamenu-opened:has(#m-theme.active) #m-save::before       { content: "ğŸ’½"; }
body.megamenu-opened:has(#m-theme.active) #m-saved::before      { content: "ğŸ”–"; }
body.megamenu-opened:has(#m-theme.active) #m-save-as::before    { content: "âœï¸"; }
body.megamenu-opened:has(#m-theme.active) #m-export::before     { content: "â¤´ï¸"; }
body.megamenu-opened:has(#m-theme.active) #m-print::before      { content: "ğŸ§¾"; }
body.megamenu-opened:has(#m-theme.active) #m-theme::before      { content: "ğŸ–Œï¸"; }
body.megamenu-opened:has(#m-theme.active) #m-preference::before { content: "ğŸ› ï¸"; }
body.megamenu-opened:has(#m-theme.active) #m-about::before      { content: "ğŸ“˜"; }
body.megamenu-opened:has(#m-theme.active) #m-close::before      { content: "â"; }

/* Saved çš„åŸæ‰“å‹¾ i æ”¾æœ€å³ */
body.megamenu-opened:has(#m-theme.active) #m-saved .fa-check-circle-o:before{
  position:absolute; right:8px; top:50%; transform: translateY(-50%); margin:0;
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list > li > a > i{
  order:0; margin-right:-20px; color:var(--sb-accent-red); font-size:1em;
}

/* åˆ†éš”çº¿ï¼ˆç²‰æ¡ï¼‰ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list > li.divider{
  height:10px; margin:6px 8px;
  border:2px solid var(--sb-bd);
  background: var(--sb-div-bg1), var(--sb-div-str);
  box-shadow: 2px 2px 0 0 var(--sb-shadow);
}

/* fa å­—ä½“ä¿®æ­£ï¼ˆä»… Theme æ¨¡å¼èœå•ï¼‰ */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list i.fa,
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-list i[class*="fa-"]{
  font-family:"FontAwesome","Segoe UI Symbol","Noto Sans Symbols",
               system-ui,-apple-system,"Segoe UI","Microsoft YaHei",sans-serif !important;
  font-style: normal;
}

/* ========================================================================== */
/* REGION E â€” THEME PREVIEW GRID Â· Varsï¼ˆé¢„è§ˆåŒºï¼šæ …æ ¼/å¡/äº¤äº’ Â· å˜é‡åŒ–ï¼‰         */
/* Scope : #megamenu-section-theme ç¬¬ä¸€ä¸ªé¢æ¿å†…çš„ h1 + #theme-preview-grid      */
/* Function : åŠé€æ˜+è½»æ¨¡ç³Šç½‘æ ¼ï¼›å¡ç‰‡ç¡¬æè¾¹/æ‰«æï¼›active å‹¾/é”®ç›˜å¯è¾¾/è§’æ ‡        */
/* Notes : åŠ¨æ•ˆå°Šé‡ prefers-reduced-motionï¼›æ‰«æå®½/æ—¶é•¿/steps å¯è°ƒ              */
/* ========================================================================== */

/* â€”â€” é¢„è§ˆåŒºå˜é‡å°±è¿‘æŒ‚åœ¨é¢æ¿æ ¹ â€”â€” */
#megamenu-section-theme{
  /* Grid å®¹å™¨ */
  --pv-gap: 14px;
  --pv-col-min: 220px;
  --pv-grid-bg: rgba(255,255,255,.82);
  --pv-grid-blur: 2.5px;
  --pv-grid-sat: 1.02;
  --pv-grid-bd: #111;
  --pv-grid-shadow: #93a5b8;

  /* é¢„è§ˆå¡ */
  --pv-card-bg: rgba(255,255,255,.94);
  --pv-card-bd: #111;
  --pv-card-inset: #fff;          /* å†…ä¾§ 2px ç™½æè¾¹ */
  --pv-card-shadow: #93a5b8;
  --pv-card-shadow-hover: #6f7f90;

  /* æ‰«æå¯¼æ¡ */
  --pv-scan-color: #ff4d6d;
  --pv-scan-width: 160px;
  --pv-scan-steps: 7;
  --pv-scan-dur: .9s;

  /* çŠ¶æ€/å¼ºè°ƒ */
  --pv-accent-blue: #009cff;
  --pv-accent-blue-2: #0078d4;
  --pv-focus-ring: #111;
  --pv-focus-accent: #009cff;
  --pv-focus-shadow: #7aa2d61f;

  /* è§’æ ‡ */
  --pv-badge-bg: linear-gradient(0deg,#e7f0ff,#fff5f8);
  --pv-badge-bd: #111;
  --pv-badge-shadow: #93a5b8;
  --pv-badge-color: #111;
}

/* æ …æ ¼å®¹å™¨ */
#megamenu-section-theme > .megamenu-menu-panel:first-of-type > h1 + #theme-preview-grid{
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--pv-col-min), 1fr));
  gap: var(--pv-gap);
  margin-top: 8px;
  padding: 10px;
  background: var(--pv-grid-bg);
  backdrop-filter: blur(var(--pv-grid-blur)) saturate(var(--pv-grid-sat));
  border: 2px solid var(--pv-grid-bd);
  box-shadow: 3px 3px 0 0 var(--pv-grid-shadow);
}

/* é¢„è§ˆå¡ */
#megamenu-section-theme #theme-preview-grid .theme-preview-div{
  position: relative;
  aspect-ratio: 16/10;
  background: var(--pv-card-bg);
  border: 2px solid var(--pv-card-bd);
  box-shadow: inset 0 0 0 2px var(--pv-card-inset), 2.5px 2.5px 0 0 var(--pv-card-shadow);
  overflow: hidden;
  transition: transform .06s steps(2,end), box-shadow .06s steps(2,end), filter .12s ease;
  cursor: pointer;
}
@supports not (aspect-ratio: 16/10){
  #megamenu-section-theme #theme-preview-grid .theme-preview-div{ height: 150px; }
}

/* é¢„è§ˆå†…å®¹ */
#megamenu-section-theme .theme-preview-div .theme-preview-content{
  width: 100%; height: 100%; border: 0; display: block; background: #fff;
}

/* è¦†ç›–å±‚äº‹ä»¶æ•æ‰ */
#megamenu-section-theme .theme-preview-div > div[style*="position:absolute"]{ pointer-events: auto; }

/* å³ä¸Šæ‰“å‹¾ï¼ˆé»˜è®¤éšè—ï¼‰ */
#megamenu-section-theme .theme-preview-div > .fa-check-circle{
  position: absolute; right: 8px; top: 8px; font-size: 18px;
  color: var(--pv-accent-blue);
  text-shadow: 0 0 2px #ffffff, 0 0 2px #ffffff;
  opacity: 0; transform: scale(.9);
  transition: opacity .12s ease, transform .12s ease;
}

/* hoverï¼šä½ç§» + ç²‰çº¢å¯¼æ¡æ‰«æ */
#megamenu-section-theme .theme-preview-div:hover{
  transform: translate(1px,10px);
  box-shadow: 4px 4px 0 0 var(--pv-card-shadow-hover), inset 0 0 0 2px #fff;
  background:
    linear-gradient(180deg,#ffffff 0%,#f7fbff 100%),
    repeating-linear-gradient(90deg,var(--pv-scan-color) 0 8px,var(--pv-scan-color) 8px 16px,transparent 16px 32px);
  background-size: auto, var(--pv-scan-width) 100%;
  animation: theme-preview-scan var(--pv-scan-dur) steps(var(--pv-scan-steps), end) infinite;
  filter: saturate(1.03) brightness(1.02);
}
@media (prefers-reduced-motion: reduce){
  #megamenu-section-theme .theme-preview-div:hover{ animation: none; }
}
@keyframes theme-preview-scan{
  from{ background-position: 0 0, 0 0; }
  to  { background-position: 0 0, var(--pv-scan-width) 0; }
}

/* activeï¼šåŠŸèƒ½è¾¹ + å‹¾æ˜¾ç° */
#megamenu-section-theme .theme-preview-div.active{
  border-color: var(--pv-accent-blue);
  box-shadow: inset 0 0 0 2px #e9f2ff, 0 0 0 2px #111, 5px 5px 0 0 var(--pv-focus-shadow);
}
#megamenu-section-theme .theme-preview-div.active > .fa-check-circle{ opacity: 1; transform: scale(1); }

/* é”®ç›˜å¯è¾¾ */
#megamenu-section-theme .theme-preview-div:focus-within{
  outline: 0;
  box-shadow: 0 0 0 2px var(--pv-focus-ring), 0 0 0 4px var(--pv-focus-accent), 5px 5px 0 0 var(--pv-focus-shadow);
}

/* å³ä¸‹è§’ data-theme å¾®æ ‡ç­¾ */
#megamenu-section-theme .theme-preview-div::after{
  content: attr(data-theme);
  position: absolute; right: 6px; bottom: 6px; padding: 2px 6px;
  font-size: 10px; line-height: 1.2; color: var(--pv-badge-color);
  background: var(--pv-badge-bg);
  border: 2px solid var(--pv-badge-bd);
  box-shadow: 2px 2px 0 0 var(--pv-badge-shadow);
  max-width: 80%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
}

/* ç¬¬äºŒä¸ªé¢æ¿é‡Œçš„â€œOpen Theme Folderâ€æŒ‰é’® */
#megamenu-section-theme #open-theme-folder-btn.long-btn{
  justify-content: center; gap: 10px; color: #111;
  border: 2px solid #111; border-radius: 0;
  background: linear-gradient(180deg,#fff5f8 0%,#f3f7fb 50%,#fff5f8 100%);
  box-shadow: 3px 3px 0 0 var(--pv-grid-shadow), inset 0 0 0 2px #fff;
  transition: transform .06s steps(2,end), background .12s ease;
}
#megamenu-section-theme #open-theme-folder-btn.long-btn:hover{
  transform: translate(-1px,-1px);
  background: linear-gradient(180deg,var(--pv-accent-blue) 0%,var(--pv-accent-blue-2) 100%);
  color:#fff;
}

/* å¦ä¸€ç‰ˆé€‰ä¸­å›¾æ ‡ï¼ˆæè¾¹è±å½¢ï¼‰â€”â€” è‹¥ä½¿ç”¨ï¼Œä¿æŒä¸ä¸Šæ–¹æ‰“å‹¾é€»è¾‘ä¸€è‡´ */
#megamenu-section-theme .theme-preview-div > .fa-check-circle{
  position: absolute; left: 300px; top: 6px; font-size: 18px; line-height: 1;
  z-index: 5; pointer-events: none;
  font-family: 'FontAwesome','Segoe UI Symbol','Noto Sans Symbols',system-ui,-apple-system,"Segoe UI","Microsoft YaHei",sans-serif;
  color: transparent; -webkit-text-stroke: 2px #ef00ff;
  text-shadow: none; opacity: 0; transform: scale(.9);
  transition: opacity .12s ease, transform .12s ease;
}
#megamenu-section-theme .theme-preview-div.active > .fa-check-circle{ opacity: 1; transform: scale(1); }
#megamenu-section-theme .theme-preview-div > .fa-check-circle:before{ content: "\f219"; } /* fa-diamond */
#megamenu-section-theme .theme-preview-div > .fa-check-circle::after{ content: none; }

/* ========================================================================== */
/* REGION F â€” SCROLLBARS Â· THEMEï¼ˆæ»šåŠ¨æ¡ Â· Theme æ¿€æ´»æ€ Â· å˜é‡åŒ–ï¼‰               */
/* Scope : Theme æ¿€æ´»æ—¶çš„ Sidebar ä¸é¡µé¢å³ä¾§ä¸»æ»šåŠ¨æ¡ï¼ˆå•é—¨é—© + åˆ†ç»„é€‰æ‹©å™¨ï¼‰       */
/* Function : ç²‰/è“åŠŸèƒ½æ»šåŠ¨æ¡ï¼›æ‹è§’/å†…æ¡†åƒç´ åŒ–ï¼›å¿…è¦å¤„å°èŒƒå›´è¦†ç›–                   */
/* ========================================================================== */

/* â€”â€” å˜é‡æŒ‚è½½ï¼šTheme æ¿€æ´»æ€»ä¼ â€”â€” */
body.megamenu-opened:has(#m-theme.active){
  /* å°ºå¯¸ */
  --th-sb-w: 10px;
  --th-sb-h: 10px;

  /* è½¨é“ / è¾¹æ¡† / å†…æ¡† */
  --th-track-bg: linear-gradient(180deg,#fff0f4 0%,#f5f9ff 100%);
  --th-bd: #111;
  --th-track-left: 2px solid var(--th-bd);
  --th-track-top:  2px solid var(--th-bd);
  --th-inset: inset 0 0 0 2px var(--th-bd);

  /* æ‹‡æŒ‡ï¼ˆSidebarï¼šçº¢ç²‰ï¼›Pageï¼šè“ï¼‰ */
  --th-thumb-red:  linear-gradient(180deg,#ff4d6d 0%,#e60026 100%);
  --th-thumb-blue: linear-gradient(180deg,#009cff 0%,#0078d4 100%);
  --th-thumb-bd: 2px solid var(--th-bd);
  --th-thumb-inset: inset 0 0 0 2px #fff;
  --th-thumb-shadow: 2px 2px 0 0 #93a5b8;

  /* æ‹è§’ */
  --th-corner-bg: linear-gradient(180deg,#fff0f4 0%,#eef5ff 100%);

  /* äº¤äº’ */
  --th-track-hover-brightness: 1.06;
  --th-hover-shift: -1px;        /* hover ä½ç§»é‡ï¼ˆè´Ÿä¸ºå‘å·¦ä¸Šï¼‰ */
  --th-track-hover-lift: -1px;   /* è½¨é“ hover ä¸Šç§»é‡ */
}

/* â€”â€” ç»Ÿä¸€å…¥å£ï¼ˆSidebar + é¡µé¢å³ä¾§å®¹å™¨ï¼‰ â€”â€” */
body.megamenu-opened:has(#m-theme.active)
:is(#megamenu-menu-sidebar, html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar{
  width: var(--th-sb-w);
  height: var(--th-sb-h);
}

body.megamenu-opened:has(#m-theme.active)
:is(#megamenu-menu-sidebar, html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-track{
  background: var(--th-track-bg);
  border-left: var(--th-track-left);
  border-top:  var(--th-track-top);
  box-shadow: var(--th-inset);
  transition: filter .25s ease, transform .25s ease;
}
body.megamenu-opened:has(#m-theme.active)
:is(#megamenu-menu-sidebar, html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-track:hover{
  filter: brightness(var(--th-track-hover-brightness));
  transform: translateY(var(--th-track-hover-lift));
}

/* â€”â€” Sidebarï¼šçº¢ç²‰æ‹‡æŒ‡ â€”â€” */
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar::-webkit-scrollbar-thumb{
  background: var(--th-thumb-red);
  border: var(--th-thumb-bd);
  box-shadow: var(--th-thumb-inset), var(--th-thumb-shadow);
  border-radius: 0;
  transition: transform .25s ease;
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar::-webkit-scrollbar-thumb:hover{
  transform: translate(var(--th-hover-shift), var(--th-hover-shift));
}
body.megamenu-opened:has(#m-theme.active) #megamenu-menu-sidebar::-webkit-scrollbar-corner{
  background: var(--th-corner-bg);
  border: 2px solid var(--th-bd);
  box-shadow: var(--th-inset);
}

/* â€”â€” é¡µé¢å³ä¾§ï¼šè“æ‹‡æŒ‡ â€”â€” */
body.megamenu-opened:has(#m-theme.active)
:where(html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-thumb{
  background: var(--th-thumb-blue);
  border: var(--th-thumb-bd);
  box-shadow: var(--th-thumb-inset), var(--th-thumb-shadow);
  border-radius: 0;
  transition: transform .25s ease;
}
body.megamenu-opened:has(#m-theme.active)
:where(html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-thumb:hover{
  transform: translate(var(--th-hover-shift), var(--th-hover-shift));
}
body.megamenu-opened:has(#m-theme.active)
:where(html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-corner{
  background: var(--th-corner-bg);
  border: 2px solid var(--th-bd);
  box-shadow: var(--th-inset);
}

/* åŠ¨æ•ˆå¯åŠæ€§ï¼šå‡å°‘è¿åŠ¨æ—¶ç¦ç”¨ä½ç§» */
@media (prefers-reduced-motion: reduce){
  body.megamenu-opened:has(#m-theme.active)
  :is(#megamenu-menu-sidebar, html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-track{
    transition: none;
  }
  body.megamenu-opened:has(#m-theme.active)
  :is(#megamenu-menu-sidebar, html, body, #megamenu-section-theme, .megamenu-section, .megamenu-menu-panel, .megamenu-content, #content, #write)::-webkit-scrollbar-thumb{
    transition: none;
  }
}

/* =============================== END OF PACKAGE ============================ */