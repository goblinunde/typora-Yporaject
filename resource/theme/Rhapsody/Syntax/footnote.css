/* =======================================================================================
   Rhapsody Â· Footnotesï¼ˆæ­£æ–‡è„šæ³¨ç³»ç»Ÿ Â· ä¸Šæ ‡ / æ–‡æœ«å¡ç‰‡ / æµ®çª—æç¤ºï¼‰
   è®¾è®¡ç†å¿µ / Design Concept
   - ä½¿ç”¨ --fn-* å±€éƒ¨å˜é‡é›†ä¸­ç»´æŠ¤è„šæ³¨è‰²å½©ã€é—´è·ã€é˜´å½±ï¼Œé¿å…æ•£ç‚¹ç¡¬ç¼–ç ã€‚
   - ä¿æŒ Typora åŸç”Ÿ DOM ç»“æ„ä¸å˜ï¼Œæ‰€æœ‰è£…é¥°ä¸æµ®çª—å‡ä»¥é€‰æ‹©å™¨çº¦æŸå®ç°ã€‚
   - äº¤äº’å±‚åˆ†ä¸‰ç±»ï¼šä¸Šæ ‡ï¼ˆsup.md-footnoteï¼‰ã€æ–‡æœ«å¡ç‰‡ï¼ˆ.footnotesï¼‰ã€æµ®çª—æç¤ºï¼ˆ.code-tooltipï¼‰ã€‚
   - æµ®çª—ä¸¥æ ¼é™å®šä¸ºâ€œçº¯æ–‡æœ¬è„šæ³¨â€ï¼Œæ˜¾å¼æ’é™¤æ•°å­¦èŠ‚ç‚¹ï¼Œé˜²æ­¢æ ·å¼ä¸²æ‰°ã€‚
   - æä¾› prefers-reduced-motion å…œåº•ï¼Œç¦ç”¨åŠ¨ç”»/è¿‡æ¸¡ä»¥é™ä½æ€§èƒ½æ¶ˆè€—ã€‚
   ======================================================================================= */

/* ========================================================================== */
/* REGION A â€” FOOTNOTE ROOT VARIABLES                                         */
/* Scope: #write                                                              */
/* Function: è„šæ³¨ä¸Šæ ‡ã€æ–‡æœ«å¡ç‰‡ã€åœ†ç‚¹ç¼–å·ã€è¿”å›ç®­å¤´çš„æ ¸å¿ƒå˜é‡                   */
/* Adjustable Params: è‰²å½©ã€å°ºå¯¸ã€é˜´å½±ã€è¿‡æ¸¡                                  */
/* ========================================================================== */
#write {
  /* ä¸Šæ ‡ */
  --fn-sup-fs: .78em;
  --fn-sup-fw: 500;
  --fn-sup-lh: 1.1;
  --fn-sup-pad-y: .04em;
  --fn-sup-pad-x: .3em;
  --fn-sup-mx: .1em;
  --fn-sup-radius: .45em;
  --fn-sup-fg: #a86a74;
  --fn-sup-bg: rgba(220,100,110,.12);
  --fn-sup-bd: #e49ca3;
  --fn-sup-hover-bg: #f5d6b8;
  --fn-sup-hover-fg: #a86a74;
  --fn-sup-hover-bd: #f5d6b8;
  --fn-sup-hover-bs: 0 0 4px #e49ca344,0 0 8px #f5d6b866;
  --fn-sup-hover-ts: 0 0 2px #fff;

  /* æ–‡æœ«å¡ç‰‡ */
  --fn-card-bg: #fff7f7;
  --fn-card-bd-left: #e49ca3;
  --fn-card-radius: .9em;
  --fn-card-pad: 1em 1.2em 1em 2.2em;
  --fn-card-my: 1.4em;
  --fn-card-bs: 0 1px 2px rgba(180,90,110,.05), 0 0 9px #e49ca315;
  --fn-card-gap: 1em;
  --fn-card-text: #8c4c5a;

  /* ç¼–å·åœ†ç‚¹ */
  --fn-num-bg: #e49ca3;
  --fn-num-fg: #fff;
  --fn-num-fs: .8rem;
  --fn-num-box: 1.65em;
  --fn-num-bs: 0 0 4px #e49ca344;

  /* è¿”å›ç®­å¤´ */
  --fn-back-fg: #e49ca3;
  --fn-back-hover-fg: #a86a74;
  --fn-back-pos-x: 1em;
  --fn-back-pos-y: .65em;
  --fn-back-scale: 1.2;

  /* åŠ¨ç”» */
  --fn-tr-slow: .25s ease;
  --fn-tr-fast: .2s ease;

  /* è£…é¥° emoji */
  --fn-emoji: "ğŸ·";
  --fn-emoji-left: .65em;
  --fn-emoji-top: .65em;
  --fn-emoji-fs: 1.18em;
  --fn-emoji-op: .68;
}

/* Scope: #write sup.md-footnote */
#write sup.md-footnote {
  display:inline-block;
  font-size:var(--fn-sup-fs);
  font-weight:var(--fn-sup-fw);
  line-height:var(--fn-sup-lh);
  padding:var(--fn-sup-pad-y) var(--fn-sup-pad-x);
  margin:0 var(--fn-sup-mx);
  border-radius:var(--fn-sup-radius);

  vertical-align:baseline;
  color:var(--fn-sup-fg);
  background:var(--fn-sup-bg);
  border:1px dashed var(--fn-sup-bd);

  text-decoration:none;
  position:relative;
  cursor:pointer;

  transition:
    color var(--fn-tr-slow),
    background-color var(--fn-tr-slow),
    border-color var(--fn-tr-slow),
    box-shadow var(--fn-tr-slow),
    text-shadow var(--fn-tr-slow);
}
#write sup.md-footnote:hover {
  background:var(--fn-sup-hover-bg);
  color:var(--fn-sup-hover-fg);
  border-color:var(--fn-sup-hover-bd);
  box-shadow:var(--fn-sup-hover-bs);
  text-shadow:var(--fn-sup-hover-ts);
}
#write sup.md-footnote:focus-visible {
  outline:2px solid currentColor;
  outline-offset:2px;
  text-decoration:underline;
}


/* Scope: #write .footnotes.md-def-footnote*/
#write .footnotes.md-def-footnote {
  background:var(--fn-card-bg);
  border-left:4px solid var(--fn-card-bd-left);
  border-radius:var(--fn-card-radius);
  padding:var(--fn-card-pad);
  margin:var(--fn-card-my) 0;
  box-shadow:var(--fn-card-bs);
  display:flex;
  align-items:flex-start;
  gap:var(--fn-card-gap);
  position:relative;
}
#write .footnotes.md-def-footnote::before {
  content:var(--fn-emoji);
  position:absolute;
  left:var(--fn-emoji-left);
  top:var(--fn-emoji-top);
  font-size:var(--fn-emoji-fs);
  opacity:var(--fn-emoji-op);
  filter:blur(.1px);
  pointer-events:none;
}
#write .footnotes .md-def-name {
  display:inline-block;
  background:var(--fn-num-bg);
  color:var(--fn-num-fg);
  font-weight:bold;
  font-size:var(--fn-num-fs);
  width:var(--fn-num-box);
  height:var(--fn-num-box);
  text-align:center;
  line-height:var(--fn-num-box);
  border-radius:50%;
  flex-shrink:0;
  box-shadow:var(--fn-num-bs);
}
#write .footnotes .md-def-content {
  font-size:.97em;
  line-height:1.7;
  color:var(--fn-card-text);
  flex:1;
  word-break:break-word;
}
#write .footnotes .md-footnote-backref {
  position:absolute;
  bottom:var(--fn-back-pos-y);
  right:var(--fn-back-pos-x);
  font-size:.9em;
  color:var(--fn-back-fg);
  text-decoration:none;
  opacity:.82;
  transition:color var(--fn-tr-fast), transform var(--fn-tr-fast), opacity var(--fn-tr-fast);
}
#write .footnotes .md-footnote-backref:hover {
  color:var(--fn-back-hover-fg);
  transform:scale(var(--fn-back-scale));
  opacity:1;
}
#write .footnotes .md-footnote-backref:focus-visible {
  outline:2px solid currentColor;
  outline-offset:2px;
}

/* ========================================================================== */
/* REGION B â€” FOOTNOTE TOOLTIP (Lite Strict)                                   */
/* Scope: ä»…â€œè„šæ³¨è§¦å‘ + çº¯æ–‡æœ¬å†…å®¹â€ï¼Œæ˜¾å¼æ’é™¤æ•°å­¦ï¼›ä¿æŒåŸäº¤äº’ä¸è§†è§‰               */
/* Notes: åˆå¹¶é€‰æ‹©å™¨ï¼Œå‡å°‘é‡å¤ï¼›ä¸æ›´æ”¹ DOM ä¸è¯­ä¹‰ã€‚                              */
/* è§¦å‘æ¡ä»¶ï¼ˆAï¼‰ï¼šé¡µé¢ä¸Šå­˜åœ¨â€œè·å¾—ç„¦ç‚¹/æ‚¬åœâ€çš„è„šæ³¨ä¸Šæ ‡ï¼Œä¸”ç›®æ ‡æµ®çª—å¿…é¡»ï¼š                   */
/*   1) .code-tooltipï¼ˆTypora åŸç”Ÿï¼‰                                                       */
/*   2) å« .md-plainï¼ˆè„šæ³¨çº¯æ–‡æœ¬ï¼‰                                                         */
/*   3) ä¸åŒ…å«ä»»æ„æ•°å­¦ç›¸å…³èŠ‚ç‚¹ï¼ˆmjx-container/.MathJax/.md-inline-math/.md-math-blockç­‰ï¼‰ */
/* ========================================================================== */

html:has(#write sup.md-footnote:is(:hover,:focus,:focus-visible))
  .code-tooltip:has(.code-tooltip-content .md-plain):not(:has(
    mjx-container, .MathJax, .md-inline-math, .md-math-block,
    .md-mathjax-preview, #math-inline-preview-content
  )){
  background:#f8ecec !important;
  border-radius:.85em;
  box-shadow:0 2px 12px #e49ca322;
  padding:.95em 1.25em;
  max-width:min(36rem,90vw);
  transform:translateY(var(--fn-tip-offset-y,0));
  outline:none;
}

/* ç®­å¤´åŒè‰²ï¼ˆåŒæ ·é™å®šä¸ºâ€œçº¯æ–‡æœ¬è„šæ³¨æµ®çª—â€ï¼Œå¹¶æ’é™¤æ•°å­¦ï¼‰ */
html:has(#write sup.md-footnote:is(:hover,:focus,:focus-visible))
  .code-tooltip.md-hover-tip:has(.code-tooltip-content .md-plain):not(:has(
    mjx-container, .MathJax, .md-inline-math, .md-math-block,
    .md-mathjax-preview, #math-inline-preview-content
  )) .md-arrow::after{
  background:#f8ecec !important;
  box-shadow:0 1px 6px rgba(228,156,163,.35);
  border-radius:2px;
}

/* A æ–‡æœ¬ç€è‰²ï¼ˆåŒæ ·ä¸¥æ ¼é™å®šä¸ºâ€œè„šæ³¨çº¯æ–‡æœ¬æµ®çª—â€ï¼‰ */
html:has(#write sup.md-footnote:is(:hover,:focus,:focus-visible))
  .code-tooltip:has(.code-tooltip-content .md-plain):not(:has(
    mjx-container, .MathJax, .md-inline-math, .md-math-block,
    .md-mathjax-preview, #math-inline-preview-content
  )) .code-tooltip-content .md-plain{
  color:#a86a74;
  font-size:1.06em;
  font-weight:600;
  text-shadow:0 0 6px #e49ca328;
  letter-spacing:.02em;
}

/* B) å…è®¸é¼ æ ‡ç§»å…¥æµ®çª—æœ¬èº«è€Œä¸ä¸­æ–­æ ·å¼ï¼ˆä»ä»…é™â€œçº¯æ–‡æœ¬è„šæ³¨æµ®çª—â€ï¼‰ */
.code-tooltip:has(.code-tooltip-content .md-plain):not(:has(
  mjx-container, .MathJax, .md-inline-math, .md-math-block,
  .md-mathjax-preview, #math-inline-preview-content
)):hover,
.code-tooltip:has(.code-tooltip-content .md-plain):not(:has(
  mjx-container, .MathJax, .md-inline-math, .md-math-block,
  .md-mathjax-preview, #math-inline-preview-content
)):focus-within{
  background:#f8ecec !important;
  border-radius:.85em;
  box-shadow:0 2px 12px #e49ca322;
  padding:.95em 1.25em;
  max-width:min(36rem,90vw);
  outline:none;
}
.code-tooltip.md-hover-tip:has(.code-tooltip-content .md-plain):not(:has(
  mjx-container, .MathJax, .md-inline-math, .md-math-block,
  .md-mathjax-preview, #math-inline-preview-content
)):is(:hover,:focus-within) .md-arrow::after{
  background:#f8ecec !important;
  box-shadow:0 1px 6px rgba(228,156,163,.35);
  border-radius:2px;
}
.code-tooltip:has(.code-tooltip-content .md-plain):not(:has(
  mjx-container, .MathJax, .md-inline-math, .md-math-block,
  .md-mathjax-preview, #math-inline-preview-content
)) :is(.code-tooltip-content .md-plain){
  color:#a86a74;
  font-size:1.06em;
  font-weight:600;
  text-shadow:0 0 6px #e49ca328;
  letter-spacing:.02em;
}

/* C) å¤åŸï¼šå½“ä¸Šæ ‡æœªæ¿€æ´»ä¸”æµ®çª—ä¹Ÿæœªè¢« hover/focus-within æ—¶ï¼Œä¸”ä»…é™â€œçº¯æ–‡æœ¬è„šæ³¨æµ®çª—â€ */
html:not(:has(#write sup.md-footnote:is(:hover,:focus,:focus-visible)))
  .code-tooltip:has(.code-tooltip-content .md-plain):not(:has(
    mjx-container, .MathJax, .md-inline-math, .md-math-block,
    .md-mathjax-preview, #math-inline-preview-content
  )):not(:hover):not(:focus-within){
  background:revert !important;
  border-radius:revert;
  box-shadow:none;
  padding:revert;
  transform:none;
  outline:none;
}
html:not(:has(#write sup.md-footnote:is(:hover,:focus,:focus-visible)))
  .code-tooltip.md-hover-tip:has(.code-tooltip-content .md-plain):not(:has(
    mjx-container, .MathJax, .md-inline-math, .md-math-block,
    .md-mathjax-preview, #math-inline-preview-content
  )):not(:hover):not(:focus-within) .md-arrow::after{
  background:revert !important;
  box-shadow:none;
  border-radius:0;
}

/* === å…œåº•ï¼šä»»ä½•â€œå«æ•°å­¦å†…å®¹â€çš„ tooltip ä¸€å¾‹å¼ºåˆ¶å¤åŸï¼Œé˜²æ­¢é»‘è±å½¢ç­‰ä¸²æ ·å¼ ================= */
.code-tooltip:has(
  mjx-container, .MathJax, .md-inline-math, .md-math-block,
  .md-mathjax-preview, #math-inline-preview-content
){
  background:revert !important;
  border-radius:revert;
  box-shadow:none;
  padding:revert;
  outline:none;
}
.code-tooltip:has(
  mjx-container, .MathJax, .md-inline-math, .md-math-block,
  .md-mathjax-preview, #math-inline-preview-content
) .md-arrow::after{
  background:revert !important;
  box-shadow:none;
  border-radius:0;
}

/* å‡å°‘åŠ¨æ€åå¥½ï¼šè„šæ³¨ç›¸å…³åŠ¨ç”»åœç”¨ */
@media (prefers-reduced-motion: reduce){
  #write .footnotes .md-footnote-backref{ transition:none; transform:none; }
  #write sup.md-footnote{ transition:none; }
  html:has(#write sup.md-footnote:is(:hover,:focus,:focus-visible))
    .code-tooltip:has(.code-tooltip-content .md-plain){ transition:none; transform:none; }
  .code-tooltip:has(.code-tooltip-content .md-plain):is(:hover,:focus-within){
    transition:none; transform:none;
  }
}
/* =============================== END OF PACKAGE ============================ */