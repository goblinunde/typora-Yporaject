/* =======================================================================================
   Rhapsody Â· Display Math Blocksï¼ˆè¡Œé—´å…¬å¼ Â· æ­£æ–‡/å‘Šè­¦ä¸€ä½“ï¼‰
   è®¾è®¡ç†å¿µ / Design Concept
   - ä¸æ­£æ–‡ä¸ md-alert è§†è§‰ç»Ÿä¸€ï¼šå±…ä¸­æ’ç‰ˆã€åˆé€‚ç•™ç™½ä¸æ¯”ä¾‹æ”¾å¤§ï¼ŒMathJax/SVG å…±ç”¨å˜é‡ã€‚
   - æ‚¬åœä»…åšè½»é‡å¼ºè°ƒï¼šæŸ”å’ŒæµåŠ¨åº•è‰² + éœ“è™¹æè¾¹ + æ–‡å­—ç¬¦å·é«˜äº®ï¼Œä¸å–§å®¾å¤ºä¸»ã€‚
   - å…¨é‡å˜é‡åŒ–ï¼ˆ--dm-*ï¼‰ï¼šå—å®¹å™¨ã€Hoverã€ç¼–è¾‘åŒº Rawblockã€é¢„è§ˆã€è£…é¥°å¡ç‰‡åˆ†å±‚å¯æ§ï¼›ä¸æ”¹ DOMã€‚
   - ç¨³å®šä¸å¯è®¿é—®ï¼šåŠ¨ç”»å¯é™çº§ã€è¿‡æ¸¡æ—¶é•¿å—æ§ï¼Œé¿å…ç¼–è¾‘æ€è·³åŠ¨ä¸è¾“å…¥å¹²æ‰°ã€‚
   ======================================================================================= */

/* â€”â€” Region Root Vars â€”â€” */
#write{
  /* A åŒºï¼šå—å®¹å™¨ä¸ SVG åŸºæœ¬ */
  --dm-block-margin-top: 0.2rem;
  --dm-block-margin-bottom: 0.2rem;
  --dm-block-pad-y: 0.4rem;
  --dm-block-pad-x: 0.2rem;
  --dm-block-z: 3;

  --dm-svg-size: 1.4em;                /* è¡Œé—´å…¬å¼æ•´ä½“æ”¾å¤§æ¯”ä¾‹ */
  --dm-font-math: 'LatinmodernmathRegular';
  --dm-svg-fg: #ed008e;                 /* è¡Œé—´å…¬å¼ä¸»è‰² */
  --dm-shadow-a: 0 0.7px 0.8px #fff;
  --dm-shadow-b: 0 1.2px 4px #23b3fc19;
  --dm-svg-trans-dur: 0.2s;
  --dm-svg-trans-ease: ease;

  /* B åŒºï¼šHover åŠ¨æ•ˆï¼ˆèƒŒæ™¯/æè¾¹/é˜´å½±/å­—ä½“é«˜äº®ï¼‰ */
  --dm-hover-grad: linear-gradient(
    135deg,
    rgba(180, 255, 220, 0.12),
    rgba(100, 255, 180, 0.18),
    rgba(180, 255, 220, 0.12)
  );
  --dm-hover-bg-size: 200% 200%;
  --dm-hover-anim-dur: 8s;
  --dm-hover-anim-ease: ease-in-out;
  --dm-hover-bd: rgba(120, 255, 200, 0.28);
  --dm-hover-radius: 1.2em;
  --dm-hover-shadow: 0 0 8px rgba(100, 255, 200, 0.12),
                     0 0 18px rgba(100, 255, 200, 0.10),
                     inset 0 0 12px rgba(60, 255, 180, 0.08);
  --dm-hover-blur: 6px;
  --dm-hover-brightness: 1.03;
  --dm-hover-trans: 0.3s;
  --dm-hover-z: 5;

  --dm-hover-svg-fg: #2100fa;
  --dm-hover-svg-shadow: 0 1.2px 1.2px #fff,
                         0 1.6px 6px #ffd70022,
                         0 0 4px #f2080d88;
  --dm-hover-svg-trans-dur: 0.25s;
  --dm-hover-svg-trans-ease: ease;

  /* C åŒºï¼šRawblock ç¼–è¾‘åŒºï¼ˆå¤å…¸æ£•ï¼‰ */
  --dm-raw-bg: rgba(210, 180, 140, 0.3);
  --dm-raw-trans: 0.25s;
  --dm-raw-hover-bg: rgba(160, 130, 100, 0.3);
  --dm-raw-hover-bd: rgba(218, 165, 32, 0.5);
  --dm-raw-hover-shadow: 0 0 6px rgba(160, 82, 45, 0.4),
                         0 0 12px rgba(255, 215, 0, 0.08);

  --dm-raw-aux-fg: #5b3a29;             /* before/after æ–‡å­—è‰² */
  --dm-raw-aux-font: 'Georgia', serif;

  --dm-raw-cm-color: #2d1e12;
  --dm-raw-cm-font: 'Fira Code', monospace;

  --dm-raw-select-bg: rgba(139, 69, 19, 0.3);
  --dm-rawblock-bg: rgba(250, 235, 215, 0.15);
  --dm-rawblock-radius: 0.8em;

  /* D åŒºï¼šé¢„è§ˆé»‘çº¢åè½¬ */
  --dm-prev-bg: #1c1c1c;
  --dm-prev-fg: #e53935;
  --dm-prev-margin-y: 0.4em;
  --dm-prev-radius: 0.6em;
  --dm-prev-z: 3;
  --dm-prev-trans: 0.35s ease;

  --dm-prev-hover-bg: #e53935;
  --dm-prev-hover-shadow: 0 2px 12px rgba(229, 57, 53, 0.35),
                          0 0 4px rgba(255, 255, 255, 0.2),
                          inset 0 0 6px rgba(0, 0, 0, 0.1);
  --dm-prev-invert-fg: #1c1c1c;

  /* E åŒºï¼šè£…é¥°å¡ç‰‡ */
  --dm-card-bg: rgba(255,255,255,0.15);
  --dm-card-bd-color: rgba(255,255,255,0.3);
  --dm-card-bd-width: 1.5px;
  --dm-card-radius: 1.2em;
  --dm-card-pad-y: 1.2em;
  --dm-card-pad-x: 1.8em;
  --dm-card-blur: 4px;
  --dm-card-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
}

/* ======================================================================================= */
/* REGION A â€” DISPLAY MATH BLOCKSï¼ˆè¡Œé—´å…¬å¼å— Â· æ­£æ–‡ + md-alert é€šç”¨ï¼‰                     */
/* Scope: #write å†…æ‰€æœ‰ mjx-container[display="true"]ï¼ˆåŒ…å« md-alertï¼‰                      */
/* åŠŸèƒ½ / Function: å±…ä¸­æ’ç‰ˆçš„è¡Œé—´å…¬å¼ï¼Œç»Ÿä¸€å­—ä½“/é¢œè‰²/é˜´å½±ï¼›Hover æ—¶å¯ç”¨åŠ¨æ€æ•ˆæœ             */
/* å¯è°ƒå‚æ•° / Adjustable Params: margin, color, font-family, text-shadow, hover effects     */
/* ======================================================================================= */

/* å¤–å±‚å®¹å™¨ï¼šå±…ä¸­å±•ç¤ºã€ä¸Šä¸‹ç•™ç™½ */
#write mjx-container.MathJax[display="true"] {
  display: block;
  text-align: center;
  margin: var(--dm-block-margin-top) auto var(--dm-block-margin-bottom) auto;
  padding: var(--dm-block-pad-y) var(--dm-block-pad-x);
  position: relative;
  z-index: var(--dm-block-z);
}

/* SVG åŒºåŸŸï¼šè‡ªé€‚åº”ç¼©æ”¾ã€ç»Ÿä¸€é…è‰² */
#write mjx-container.MathJax[display="true"] svg {
  font-size: var(--dm-svg-size); /* â¬…ï¸ è°ƒæ•´è¿™é‡Œï¼Œæ•´ä½“æ”¾å¤§è¡Œé—´å…¬å¼ */
  display: inline-block;
  max-width: 100%;
  height: auto;
  vertical-align: middle;
  font-family: var(--dm-font-math);
  color: var(--dm-svg-fg);
  fill: none; /* â† åŸåœ°ä¿®æ”¹ï¼šé»˜è®¤ä¸å¡«å……ï¼Œé¿å… \boxed çš„ <rect> å˜å®å¿ƒ */
  box-sizing: border-box;
  transition: color var(--dm-svg-trans-dur) var(--dm-svg-trans-ease),
              fill  var(--dm-svg-trans-dur) var(--dm-svg-trans-ease);
  text-shadow: var(--dm-shadow-a), var(--dm-shadow-b);
}
/* ä»…ç»™å­—å½¢è·¯å¾„ä¸Šè‰²ï¼›å‡ ä½•å›¾å½¢ä¿æŒé€æ˜å¡«å…… */
#write mjx-container.MathJax[display="true"] svg path { 
  fill: currentColor;
}

/* â€”â€” ä¿æŒå‡ ä½•å…ƒç´ é»˜è®¤é€æ˜å¡«å……ï¼ˆç”¨äº \boxed ç­‰ç©ºå¿ƒæ•ˆæœï¼‰ â€”â€” */
#write mjx-container.MathJax[display="true"] svg rect,
#write mjx-container.MathJax[display="true"] svg polyline,
#write mjx-container.MathJax[display="true"] svg polygon,
#write mjx-container.MathJax[display="true"] svg circle,
#write mjx-container.MathJax[display="true"] svg ellipse { 
  fill: none !important;
}

/* â€”â€” æŠŠâ€œè¢«æ¸…æ‰çš„æ•°å­¦æ¨ªçº¿/ç¬¦å·â€åŠ å›æ¥ â€”â€” */
/* 1) åˆ†æ•°çº¿ï¼ˆmfracï¼‰ã€æ ¹å·æ¨ªçº¿ï¼ˆmsqrt/mrootï¼‰ã€ä¸Š/ä¸‹åˆ’çº¿ï¼ˆmover/munder/munderoverï¼‰ */
#write mjx-container.MathJax[display="true"] g[data-mml-node="mfrac"] rect,
#write mjx-container.MathJax[display="true"] g[data-mml-node="msqrt"] rect,
#write mjx-container.MathJax[display="true"] g[data-mml-node="mroot"] rect,
#write mjx-container.MathJax[display="true"] g[data-mml-node="mover"] rect,
#write mjx-container.MathJax[display="true"] g[data-mml-node="munder"] rect,
#write mjx-container.MathJax[display="true"] g[data-mml-node="munderover"] rect {
  fill: currentColor !important;
}

/* 2) å¯æ‹‰ä¼¸ç¬¦å·ï¼ˆé•¿å¤§æ‹¬å·ã€é•¿ç­‰å·ã€ç§¯åˆ†å·ç­‰ï¼‰ï¼Œä»¥åŠç®­å¤´ä¸‰è§’å½¢ */
#write mjx-container.MathJax[display="true"] svg path.mjx-stretchy,
#write mjx-container.MathJax[display="true"] svg polygon.mjx-arrow {
  fill: currentColor !important;
  stroke: currentColor !important;
}

/* 3) ä»»ä½• <line>ï¼ˆæœ‰äº›æ„å‹ç”¨ line ç”»ï¼‰ä¸€å¾‹ç”¨å½“å‰æ–‡å­—è‰²æè¾¹ */
#write mjx-container.MathJax[display="true"] svg line { 
  stroke: currentColor !important;
}

/* è®©å¸¦ stroke çš„å…ƒç´ ï¼ˆå¦‚ \boxed çš„ <rect>ï¼‰ä½¿ç”¨å½“å‰æ–‡å­—è‰²æè¾¹ */
#write mjx-container.MathJax[display="true"] svg [stroke] {
  stroke: currentColor;
}


/* ======================================================================================= */
/* REGION B â€” DISPLAY MATH HOVERï¼ˆè¡Œé—´å…¬å¼ Hover åŠ¨æ•ˆï¼‰                                    */
/* Scope: #write mjx-container[display="true"]:hover                                        */
/* åŠŸèƒ½ / Function: é¼ æ ‡æ‚¬åœæ—¶åŠ åº•è‰²æµåŠ¨èƒŒæ™¯ã€æŸ”å…‰è¾¹æ¡†ã€å­—ä½“é«˜äº®                             */
/* ======================================================================================= */

/* ğŸš« ç§»é™¤ Typora é»˜è®¤ hover è“èƒŒæ™¯ï¼ˆç¼–è¾‘æ€ï¼‰ */
#write .md-rawblock:hover,
#write .md-rawblock:hover > .md-rawblock-container {
  background: transparent !important;
}

/* Hover ä¸»å®¹å™¨ï¼šæŸ”å’ŒæµåŠ¨ç»¿å…‰èƒŒæ™¯ */
#write mjx-container.MathJax[display="true"]:hover {
  background: var(--dm-hover-grad);
  background-size: var(--dm-hover-bg-size);
  animation: formula-hover-flow var(--dm-hover-anim-dur) var(--dm-hover-anim-ease) infinite;

  border: 1.5px solid var(--dm-hover-bd);
  border-radius: var(--dm-hover-radius);

  box-shadow: var(--dm-hover-shadow);

  backdrop-filter: blur(var(--dm-hover-blur)) brightness(var(--dm-hover-brightness));
  transition: all var(--dm-hover-trans) ease-in-out;
  z-index: var(--dm-hover-z);
}

/* Hover æ—¶å­—ä½“é«˜äº® */
#write mjx-container.MathJax[display="true"]:hover svg {
  color: var(--dm-hover-svg-fg);
  /* â† åŸåœ°ä¿®æ”¹ï¼šç§»é™¤ fill: currentColor; ä»…æå‡æ–‡å­—è‰²ä¸é˜´å½± */
  text-shadow: var(--dm-hover-svg-shadow);
  transition: color var(--dm-hover-svg-trans-dur) var(--dm-hover-svg-trans-ease),
              text-shadow var(--dm-hover-svg-trans-dur) var(--dm-hover-svg-trans-ease);
}

/* è·¯å¾„é¢œè‰²ä¿æŒä¸€è‡´ */
#write mjx-container.MathJax[display="true"]:hover svg path {
  fill: var(--dm-hover-svg-fg);
}
#write mjx-container.MathJax[display="true"]:hover svg [stroke] {
  stroke: var(--dm-hover-svg-fg);
}

/* åŠ¨æ€èƒŒæ™¯åŠ¨ç”»ï¼ˆæµåŠ¨æ„Ÿï¼‰ */
@keyframes formula-hover-flow {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}


/* ======================================================================================= */
/* REGION C â€” DISPLAY MATH RAWBLOCKï¼ˆç¼–è¾‘åŒº Â· å¤å…¸æ£•è‰²ä¸»é¢˜ï¼‰                               */
/* Scope: #write .md-rawblock-controlï¼ˆå…¬å¼ç¼–è¾‘åŒºï¼‰                                         */
/* åŠŸèƒ½ / Function: è¡Œé—´å…¬å¼ç¼–è¾‘åŒºåŸŸçš„ CodeMirror å¤–å£³ä¸ hover æ ·å¼                          */
/* ======================================================================================= */

#write .md-rawblock-control {
  background: var(--dm-raw-bg);
  z-index: var(--dm-block-z);
  transition: all var(--dm-raw-trans) ease;
}

#write .md-rawblock-control:hover {
  background: var(--dm-raw-hover-bg);
  border-color: var(--dm-raw-hover-bd);
  box-shadow: var(--dm-raw-hover-shadow);
}

#write .md-rawblock-control .ty-input-before,
#write .md-rawblock-control .ty-input-after {
  background: transparent;
  color: var(--dm-raw-aux-fg);
  border: none;
  font-family: var(--dm-raw-aux-font);
  font-weight: bold;
}

#write .md-rawblock-control .CodeMirror {
  background: transparent;
  color: var(--dm-raw-cm-color);
  font-family: var(--dm-raw-cm-font);
}

#write .md-rawblock-control .cm-s-typora span.CodeMirror-selectedtext {
  background-color: var(--dm-raw-select-bg);
}

#write .md-rawblock {
  background: var(--dm-rawblock-bg);
  border-radius: var(--dm-rawblock-radius);
}


/* ======================================================================================= */
/* REGION D â€” DISPLAY MATH PREVIEWï¼ˆé»‘çº¢åè½¬é¢„è§ˆé£æ ¼ï¼‰                                     */
/* Scope: #write .md-mathjax-preview                                                       */
/* åŠŸèƒ½ / Function: ç¼–è¾‘æ€é¢„è§ˆçš„åè½¬é»‘çº¢é£æ ¼ï¼Œhover æ—¶åˆ‡æ¢å‰æ™¯/èƒŒæ™¯                         */
/* ======================================================================================= */

#write .md-mathjax-preview {
  background: var(--dm-prev-bg);
  color: var(--dm-prev-fg);
  display: block;
  margin: var(--dm-prev-margin-y) 0;
  border-radius: var(--dm-prev-radius);
  position: relative;
  z-index: var(--dm-prev-z);
  cursor: pointer;
  transition: all var(--dm-prev-trans);
  box-sizing: border-box;
}

/* åŸåœ°æ›¿æ¢ï¼šåªç»™å­—å½¢å¡«å……è‰²ï¼Œæè¾¹åŒè‰²ï¼›ä¸å†å¯¹ * ç»Ÿä¸€å¡«å…… */
#write .md-mathjax-preview mjx-container svg path {
  fill: var(--dm-prev-fg);
}
#write .md-mathjax-preview mjx-container svg [stroke] {
  stroke: var(--dm-prev-fg);
}

#write .md-mathjax-preview:hover {
  background: var(--dm-prev-hover-bg);
  box-shadow: var(--dm-prev-hover-shadow);
}
#write .md-mathjax-preview:hover mjx-container svg path {
  fill: var(--dm-prev-invert-fg);
}
#write .md-mathjax-preview:hover mjx-container svg [stroke] {
  stroke: var(--dm-prev-invert-fg);
}


/* ======================================================================================= */
/* REGION E â€” DISPLAY MATH DECORATIVE CARDï¼ˆèƒŒæ™¯å¡ç‰‡è£…é¥°ï¼‰                                 */
/* Scope: #write .md-rawblock-control mjx-container                                         */
/* åŠŸèƒ½ / Function: ä¸ºç¼–è¾‘åŒºå…¬å¼å—æ·»åŠ æ¯›ç»ç’ƒ+æè¾¹çš„å¡ç‰‡è£…é¥°                                 */
/* ======================================================================================= */

#write .md-rawblock-control mjx-container.MathJax[display="true"] {
  background: var(--dm-card-bg);
  border: var(--dm-card-bd-width) solid var(--dm-card-bd-color);
  border-radius: var(--dm-card-radius);
  padding: var(--dm-card-pad-y) var(--dm-card-pad-x);
  backdrop-filter: blur(var(--dm-card-blur));
  box-shadow: var(--dm-card-shadow);
}
/* =============================== END OF PACKAGE ============================ */
